<!DOCTYPE html>
<html>
  <head>
    <title>A Trivial Example</title>
    <script type="text/javascript" src="../src/ftv.js"></script>
    <script type="text/javascript" src="../src/timeseries.js"></script>
  </head>
  <body>
    <div style="font-size: xx-large;">
      All series have 400 points. The following graphs have 5, 50, and
      1000 series respectively.
    </div>
    <hr/>
    <div id="c0"></div>
    <hr/>
    <div id="c1"></div>
    <hr/>
    <div id="c2"></div>
    <script type="text/javascript">
      var createTimeHighlightHandler_ = function(div) {
        return function(time, value) {
          var html = (
              "<span style='" +
              "font-family: \"courier\"; " +
              "font-size: small; " +
              "color: " + div.ts.getColor() + "; " +
              "'>" +
              "<span style='float: left; width: 80px;'>" +
              div.ts.name + "</span>");
          if (time == null)
            var t = "&mdash;";
          else
            var t = (new Date(time)).toLocaleTimeString();
          if (value == null)
            var v = "&mdash;";
          else
            var v = Math.round(100 * value) / 100;
          html += (
              "<span style='float: left; width: 160px;'>" + t + "</span>" +
              "<span>" + v + "</span></span>");
          div.innerHTML = html;
        };
      };

      var createGraph = function(divId, numSeries, numPoints) {
        var container = document.getElementById(divId);
        var now = (new Date()).getTime();
        var tsArray = [];
        for (var t = 0; t < numSeries; ++t) {
          var timestamps = new Float64Array(numPoints);
          var values = new Float64Array(numPoints);
          var gappiness = 50 * Math.random();
          var gapPhase = 200 * Math.random();
          for (var p = 0; p <= numPoints; p += 1) {
            timestamps[p] = now + (p * 1000);
            if ((p + gapPhase) % 100 < gappiness) {
              values[p] = NaN;
            } else {
              values[p] = Math.sin((p + t * 200 / numSeries)
                                   * Math.PI * 2 / numPoints);
            }
          }
          ts = new Timeseries("s" + t, timestamps, values);
          ts.setColor("rgb(" +
                      Math.floor(Math.random() * 192) + ", " +
                      Math.floor(Math.random() * 192) + ", " +
                      Math.floor(Math.random() * 192) + ")");
          tsArray[tsArray.length] = ts;
          if (t < 50) {
            var seriesDiv = document.createElement("div");
            seriesDiv.ts = ts;
            seriesDiv.onmouseover = function() {
              this.ts.highlight();
              this.style['font-weight'] = 'bold';
            };
            seriesDiv.onmouseout = function() {
              this.ts.unhighlight();
              this.style['font-weight'] = 'normal';
            };
            var handler = createTimeHighlightHandler_(seriesDiv);
            handler(null, null);
            ts.setTimeHighlightHandler(handler);
            container.appendChild(seriesDiv);
          }
        }
        ftv = new FTV(divId);
        ftv.addTimeseriesSet(new TimeseriesSet(tsArray, "unitless"));
        ftv.start();
      }

      createGraph("c0", 5, 400);
      createGraph("c1", 50, 400);
      createGraph("c2", 1000, 400);
    </script>
  </body>
</html>
